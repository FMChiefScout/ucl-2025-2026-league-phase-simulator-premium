<script type="text/javascript">
        var gk_isXlsx = false;
        var gk_xlsxFileLookup = {};
        var gk_fileData = {};
        function filledCell(cell) {
          return cell !== '' && cell != null;
        }
        function loadFileData(filename) {
        if (gk_isXlsx && gk_xlsxFileLookup[filename]) {
            try {
                var workbook = XLSX.read(gk_fileData[filename], { type: 'base64' });
                var firstSheetName = workbook.SheetNames[0];
                var worksheet = workbook.Sheets[firstSheetName];

                // Convert sheet to JSON to filter blank rows
                var jsonData = XLSX.utils.sheet_to_json(worksheet, { header: 1, blankrows: false, defval: '' });
                // Filter out blank rows (rows where all cells are empty, null, or undefined)
                var filteredData = jsonData.filter(row => row.some(filledCell));

                // Heuristic to find the header row by ignoring rows with fewer filled cells than the next row
                var headerRowIndex = filteredData.findIndex((row, index) =>
                  row.filter(filledCell).length >= filteredData[index + 1]?.filter(filledCell).length
                );
                // Fallback
                if (headerRowIndex === -1 || headerRowIndex > 25) {
                  headerRowIndex = 0;
                }

                // Convert filtered JSON back to CSV
                var csv = XLSX.utils.aoa_to_sheet(filteredData.slice(headerRowIndex)); // Create a new sheet from filtered array of arrays
                csv = XLSX.utils.sheet_to_csv(csv, { header: 1 });
                return csv;
            } catch (e) {
                console.error(e);
                return "";
            }
        }
        return gk_fileData[filename] || "";
        }
        </script><!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>UCL 2025/26 Match Simulator</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@700&family=Inter:wght@400;600&display=swap" rel="stylesheet">
    <style>
        body {
            background: #1B3A6A;
            color: #ffffff;
            font-family: 'Inter', sans-serif;
            margin: 0;
            padding: 0;
            overflow-x: hidden;
        }
        header {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            background: linear-gradient(90deg, #1B3A6A, #2A4A8A);
            z-index: 1000;
            padding: 0.5rem 1rem;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.3);
        }
        .logo {
            width: 40px;
            height: 40px;
            animation: rotateLogo 10s linear infinite;
        }
        @keyframes rotateLogo {
            from { transform: rotate(0deg); }
            to { transform: rotate(360deg); }
        }
        .main-container {
            display: flex;
            flex-direction: row;
            width: 100vw;
            max-height: 600px;
            margin: 80px auto 0;
            gap: 0.5rem;
            padding: 0 1rem;
        }
        .matches-container {
            flex: 3;
            max-height: 600px;
            overflow-y: auto;
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(12px);
            border: 1px solid rgba(192, 192, 192, 0.3);
            border-radius: 0.5rem;
            padding: 1rem;
            animation: fadeIn 0.5s ease;
            scrollbar-width: thin;
            scrollbar-color: #FFD700 #1B3A6A;
        }
        .table-container {
            flex: 7;
            max-height: 600px;
            overflow-y: auto;
            scrollbar-width: thin;
            scrollbar-color: #FFD700 #1B3A6A;
        }
        .matches-container::-webkit-scrollbar, .table-container::-webkit-scrollbar {
            width: 6px;
        }
        .matches-container::-webkit-scrollbar-track, .table-container::-webkit-scrollbar-track {
            background: #1B3A6A;
        }
        .matches-container::-webkit-scrollbar-thumb, .table-container::-webkit-scrollbar-thumb {
            background: #FFD700;
            border-radius: 3px;
        }
        .matchday-header {
            cursor: pointer;
            transition: background-color 0.3s;
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.2);
        }
        .matchday-header:hover {
            background: rgba(255, 215, 0, 0.2);
        }
        .match-card {
            background: rgba(255, 255, 255, 0.05);
            backdrop-filter: blur(12px);
            border: 1px solid rgba(192, 192, 192, 0.3);
            transition: transform 0.3s, box-shadow 0.3s;
        }
        .match-card:hover {
            transform: translateY(-3px);
            box-shadow: 0 6px 12px rgba(0, 0, 0, 0.3);
        }
        .score-input {
            width: 2.5rem;
            text-align: center;
            background: rgba(255, 255, 255, 0.1);
            color: #ffffff;
            border: 1px solid #C0C0C0;
            border-radius: 0.5rem;
            padding: 0.2rem;
            font-size: 0.8rem;
            transition: border-color 0.3s;
        }
        .score-input:focus {
            border-color: #FFD700;
            outline: none;
        }
        .league-table {
            max-width: 800px;
            width: 100%;
            margin: 0 auto;
            border-collapse: collapse;
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(12px);
            border: 1px solid #FFD700;
            border-radius: 0.5rem;
            overflow: hidden;
        }
        .league-table thead {
            position: sticky;
            top: 0;
            background: linear-gradient(90deg, #1B3A6A, #2A4A8A);
            z-index: 10;
        }
        .league-table th {
            font-family: 'Montserrat', sans-serif;
            font-size: 1rem;
            font-weight: 700;
            color: #FFD700;
            padding: 0.75rem;
            text-align: left;
            border-bottom: 1px solid rgba(192, 192, 192, 0.3);
        }
        .league-table tr {
            transition: transform 0.3s, box-shadow 0.3s;
            animation: fadeIn 0.5s ease;
            border-bottom: 1px solid #FFD700;
        }
        .league-table tr:hover {
            transform: scale(1.02);
            box-shadow: 0 0 12px rgba(255, 215, 0, 0.7);
            animation: pulseGlow 1s infinite;
        }
        .league-table td {
            font-size: 0.9rem;
            padding: 0.75rem;
            height: 2.5rem;
            color: #000000;
        }
        .league-table tr.top-8 {
            background: linear-gradient(90deg, rgba(52, 211, 153, 0.3), rgba(255, 255, 255, 0.1));
        }
        .league-table tr.playoff {
            background: linear-gradient(90deg, rgba(250, 204, 21, 0.3), rgba(255, 255, 255, 0.1));
        }
        .league-table tr.eliminated {
            background: linear-gradient(90deg, rgba(239, 68, 68, 0.3), rgba(255, 255, 255, 0.1));
        }
        .team-cell {
            display: block;
        }
        .legend {
            display: flex;
            gap: 0.5rem;
            margin-top: 0.5rem;
            justify-content: center;
            font-size: 0.8rem;
        }
        .legend-item {
            display: flex;
            align-items: center;
            gap: 0.3rem;
        }
        .legend-color {
            width: 0.8rem;
            height: 0.8rem;
            border-radius: 0.2rem;
        }
        .rating {
            font-size: 0.7rem;
            padding: 0.15rem 0.3rem;
            border-radius: 0.2rem;
            color: white;
        }
        .rating-high { background-color: #34D399; }
        .rating-mid { background-color: #FACC15; }
        .rating-low { background-color: #EF4444; }
        .tooltip {
            position: relative;
            display: inline-block;
        }
        .tooltip .tooltip-text {
            visibility: hidden;
            width: 160px;
            background: rgba(27, 58, 106, 0.9);
            backdrop-filter: blur(12px);
            color: #fff;
            text-align: center;
            border-radius: 0.5rem;
            padding: 0.4rem;
            position: absolute;
            z-index: 10;
            bottom: 125%;
            left: 50%;
            transform: translateX(-50%) scale(0.8);
            opacity: 0;
            transition: opacity 0.3s, transform 0.3s;
            font-size: 0.7rem;
        }
        .tooltip:hover .tooltip-text {
            visibility: visible;
            opacity: 1;
            transform: translateX(-50%) scale(1);
        }
        .action-button {
            transition: background-color 0.3s, transform 0.3s;
            font-size: 0.8rem;
            padding: 0.3rem 0.8rem;
            background: #FFD700;
            color: #1B3A6A;
            border-radius: 0.5rem;
        }
        .action-button:hover {
            background: #C0C0C0;
            transform: scale(1.05);
        }
        .toggle-container {
            display: flex;
            align-items: center;
            gap: 0.3rem;
        }
        .condition {
            font-size: 0.6rem;
            padding: 0.15rem 0.3rem;
            border-radius: 0.2rem;
            color: white;
        }
        .condition-fatigued { background-color: #FACC15; }
        .condition-injured { background-color: #EF4444; }
        .condition-hot { background-color: #34D399; }
        .condition-cold { background-color: #3B82F6; }
        @keyframes highlight {
            0% { background: linear-gradient(90deg, rgba(255, 215, 0, 0.4), rgba(255, 255, 255, 0.2)); }
            100% { background: linear-gradient(90deg, rgba(255, 255, 255, 0.1), rgba(255, 255, 255, 0.1)); }
        }
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        @keyframes pulseGlow {
            0% { box-shadow: 0 0 8px rgba(255, 215, 0, 0.5); }
            50% { box-shadow: 0 0 12px rgba(255, 215, 0, 0.7); }
            100% { box-shadow: 0 0 8px rgba(255, 215, 0, 0.5); }
        }
        @media (max-width: 1280px) {
            .main-container {
                flex-direction: column;
                max-height: none;
            }
            .matches-container, .table-container {
                flex: none;
                width: 100%;
                max-height: 400px;
            }
            .league-table {
                max-width: 100%;
            }
            .league-table th {
                font-size: 0.9rem;
                padding: 0.5rem;
            }
            .league-table td {
                font-size: 0.8rem;
                padding: 0.5rem;
                height: 2rem;
            }
        }
    </style>
</head>
<body>
    <header class="flex items-center justify-between">
        <div class="flex items-center gap-2">
            <svg class="logo" viewBox="0 0 24 24" fill="none" stroke="#FFD700" stroke-width="2">
                <path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 18c-4.41 0-8-3.59-8-8s3.59-8 8-8 8 3.59 8 8-3.59 8-8 8z"/>
                <path d="M12 6v12M6 12h12"/>
            </svg>
            <h1 class="text-2xl font-bold font-montserrat">UCL 2025/26 Simulator</h1>
        </div>
        <div class="flex items-center gap-2">
            <div class="toggle-container">
                <input type="checkbox" id="conditions-toggle" class="h-4 w-4" aria-label="Toggle dynamic conditions">
                <label for="conditions-toggle" class="text-xs font-inter tooltip">
                    Conditions
                    <span class="tooltip-text">Adjust predictions for fatigue, injuries, and form.</span>
                </label>
            </div>
            <button id="predict-button" class="action-button font-inter tooltip" aria-label="Predict all match scores">
                Predict
                <span class="tooltip-text">Generate scores using ratings, conditions, and Poisson model.</span>
            </button>
            <button id="reset-button" class="action-button font-inter" aria-label="Reset all scores and conditions">Reset</button>
        </div>
    </header>
    <div class="main-container">
        <div class="matches-container">
            <h2 class="text-xl font-bold font-montserrat mb-3">Matches</h2>
            <div id="matchdays" class="space-y-2"></div>
        </div>
        <div class="table-container">
            <h2 class="text-xl font-bold font-montserrat mb-3 text-center">League Table</h2>
            <table id="leagueTable" class="league-table">
                <thead>
                    <tr>
                        <th style="width: 6%;">Pos</th>
                        <th style="width: 40%;">Team</th>
                        <th style="width: 6%;">P</th>
                        <th style="width: 6%;">W</th>
                        <th style="width: 6%;">D</th>
                        <th style="width: 6%;">L</th>
                        <th style="width: 6%;">GF</th>
                        <th style="width: 6%;">GA</th>
                        <th style="width: 6%;">GD</th>
                        <th style="width: 6%;">Pts</th>
                    </tr>
                </thead>
                <tbody id="leagueTableBody"></tbody>
            </table>
            <div class="legend">
                <div class="legend-item"><span class="legend-color" style="background-color: #34D399;"></span> Top 8: Round of 16</div>
                <div class="legend-item"><span class="legend-color" style="background-color: #FACC15;"></span> 9th-24th: Play-offs</div>
                <div class="legend-item"><span class="legend-color" style="background-color: #EF4444;"></span> 25th-36th: Eliminated</div>
            </div>
        </div>
    </div>

    <script>
        const teamRatings = {
            "Real Madrid": 92, "Manchester City": 90, "Paris Saint-Germain": 89, "Bayern München": 88, "Liverpool": 87, "Arsenal": 86, "Barcelona": 85,
            "Inter": 84, "Chelsea": 83, "Juventus": 82, "Atlético de Madrid": 81, "Borussia Dortmund": 80, "Tottenham": 79, "Leverkusen": 78,
            "Newcastle United": 77, "Benfica": 76, "Napoli": 75, "Ajax": 74, "Atalanta": 73, "Marseille": 72, "Villarreal": 71, "Sporting CP": 70,
            "Monaco": 69, "PSV Eindhoven": 68, "Frankfurt": 67, "Galatasaray": 66, "Club Brugge": 65, "Union Saint-Gilloise": 64, "Athletic Club": 63,
            "Copenhagen": 62, "Slavia Praha": 61, "Olympiacos": 60, "Bodø/Glimt": 59, "Qarabağ": 58, "Kairat Almaty": 55, "Pafos": 50
        };

        const matches = [
            [
                { home: "Athletic Club", away: "Arsenal", date: "16/09/2025", time: "18:45" },
                { home: "PSV Eindhoven", away: "Union Saint-Gilloise", date: "16/09/2025", time: "18:45" },
                { home: "Juventus", away: "Borussia Dortmund", date: "16/09/2025", time: "21:00" },
                { home: "Real Madrid", away: "Marseille", date: "16/09/2025", time: "21:00" },
                { home: "Benfica", away: "Qarabağ", date: "16/09/2025", time: "21:00" },
                { home: "Tottenham", away: "Villarreal", date: "16/09/2025", time: "21:00" },
                { home: "Olympiacos", away: "Pafos", date: "17/09/2025", time: "18:45" },
                { home: "Slavia Praha", away: "Bodø/Glimt", date: "17/09/2025", time: "18:45" },
                { home: "Ajax", away: "Inter", date: "17/09/2025", time: "21:00" },
                { home: "Bayern München", away: "Chelsea", date: "17/09/2025", time: "21:00" },
                { home: "Liverpool", away: "Atlético de Madrid", date: "17/09/2025", time: "21:00" },
                { home: "Paris Saint-Germain", away: "Atalanta", date: "17/09/2025", time: "21:00" },
                { home: "Club Brugge", away: "Monaco", date: "18/09/2025", time: "18:45" },
                { home: "Copenhagen", away: "Leverkusen", date: "18/09/2025", time: "18:45" },
                { home: "Frankfurt", away: "Galatasaray", date: "18/09/2025", time: "21:00" },
                { home: "Manchester City", away: "Napoli", date: "18/09/2025", time: "21:00" },
                { home: "Newcastle United", away: "Barcelona", date: "18/09/2025", time: "21:00" },
                { home: "Sporting CP", away: "Kairat Almaty", date: "18/09/2025", time: "21:00" }
            ],
            [
                { home: "Atalanta", away: "Club Brugge", date: "30/09/2025", time: "18:45" },
                { home: "Kairat Almaty", away: "Real Madrid", date: "30/09/2025", time: "18:45" },
                { home: "Atlético de Madrid", away: "Frankfurt", date: "30/09/2025", time: "21:00" },
                { home: "Chelsea", away: "Benfica", date: "30/09/2025", time: "21:00" },
                { home: "Inter", away: "Slavia Praha", date: "30/09/2025", time: "21:00" },
                { home: "Bodø/Glimt", away: "Tottenham", date: "30/09/2025", time: "21:00" },
                { home: "Galatasaray", away: "Liverpool", date: "30/09/2025", time: "21:00" },
                { home: "Marseille", away: "Ajax", date: "30/09/2025", time: "21:00" },
                { home: "Pafos", away: "Bayern München", date: "30/09/2025", time: "21:00" },
                { home: "Qarabağ", away: "Copenhagen", date: "01/10/2025", time: "18:45" },
                { home: "Union Saint-Gilloise", away: "Newcastle United", date: "01/10/2025", time: "18:45" },
                { home: "Arsenal", away: "Olympiacos", date: "01/10/2025", time: "21:00" },
                { home: "Monaco", away: "Manchester City", date: "01/10/2025", time: "21:00" },
                { home: "Leverkusen", away: "PSV Eindhoven", date: "01/10/2025", time: "21:00" },
                { home: "Borussia Dortmund", away: "Athletic Club", date: "01/10/2025", time: "21:00" },
                { home: "Barcelona", away: "Paris Saint-Germain", date: "01/10/2025", time: "21:00" },
                { home: "Napoli", away: "Sporting CP", date: "01/10/2025", time: "21:00" },
                { home: "Villarreal", away: "Juventus", date: "01/10/2025", time: "21:00" }
            ],
            [
                { home: "Barcelona", away: "Olympiacos", date: "21/10/2025", time: "18:45" },
                { home: "Kairat Almaty", away: "Pafos", date: "21/10/2025", time: "18:45" },
                { home: "Arsenal", away: "Atlético de Madrid", date: "21/10/2025", time: "21:00" },
                { home: "Leverkusen", away: "Paris Saint-Germain", date: "21/10/2025", time: "21:00" },
                { home: "Copenhagen", away: "Borussia Dortmund", date: "21/10/2025", time: "21:00" },
                { home: "Newcastle United", away: "Benfica", date: "21/10/2025", time: "21:00" },
                { home: "PSV Eindhoven", away: "Napoli", date: "21/10/2025", time: "21:00" },
                { home: "Union Saint-Gilloise", away: "Inter", date: "21/10/2025", time: "21:00" },
                { home: "Villarreal", away: "Manchester City", date: "21/10/2025", time: "21:00" },
                { home: "Athletic Club", away: "Qarabağ", date: "22/10/2025", time: "18:45" },
                { home: "Galatasaray", away: "Bodø/Glimt", date: "22/10/2025", time: "18:45" },
                { home: "Monaco", away: "Tottenham", date: "22/10/2025", time: "21:00" },
                { home: "Atalanta", away: "Slavia Praha", date: "22/10/2025", time: "21:00" },
                { home: "Chelsea", away: "Ajax", date: "22/10/2025", time: "21:00" },
                { home: "Frankfurt", away: "Liverpool", date: "22/10/2025", time: "21:00" },
                { home: "Bayern München", away: "Club Brugge", date: "22/10/2025", time: "21:00" },
                { home: "Real Madrid", away: "Juventus", date: "22/10/2025", time: "21:00" },
                { home: "Sporting CP", away: "Marseille", date: "22/10/2025", time: "21:00" }
            ],
            [
                { home: "Slavia Praha", away: "Arsenal", date: "04/11/2025", time: "18:45" },
                { home: "Napoli", away: "Frankfurt", date: "04/11/2025", time: "18:45" },
                { home: "Atlético de Madrid", away: "Union Saint-Gilloise", date: "04/11/2025", time: "21:00" },
                { home: "Bodø/Glimt", away: "Monaco", date: "04/11/2025", time: "21:00" },
                { home: "Juventus", away: "Sporting CP", date: "04/11/2025", time: "21:00" },
                { home: "Liverpool", away: "Real Madrid", date: "04/11/2025", time: "21:00" },
                { home: "Olympiacos", away: "PSV Eindhoven", date: "04/11/2025", time: "21:00" },
                { home: "Paris Saint-Germain", away: "Bayern München", date: "04/11/2025", time: "21:00" },
                { home: "Tottenham", away: "Copenhagen", date: "04/11/2025", time: "21:00" },
                { home: "Pafos", away: "Villarreal", date: "05/11/2025", time: "18:45" },
                { home: "Qarabağ", away: "Chelsea", date: "05/11/2025", time: "18:45" },
                { home: "Ajax", away: "Galatasaray", date: "05/11/2025", time: "21:00" },
                { home: "Club Brugge", away: "Barcelona", date: "05/11/2025", time: "21:00" },
                { home: "Inter", away: "Kairat Almaty", date: "05/11/2025", time: "21:00" },
                { home: "Manchester City", away: "Borussia Dortmund", date: "05/11/2025", time: "21:00" },
                { home: "Newcastle United", away: "Athletic Club", date: "05/11/2025", time: "21:00" },
                { home: "Marseille", away: "Atalanta", date: "05/11/2025", time: "21:00" },
                { home: "Benfica", away: "Leverkusen", date: "05/11/2025", time: "21:00" }
            ],
            [
                { home: "Ajax", away: "Benfica", date: "25/11/2025", time: "18:45" },
                { home: "Galatasaray", away: "Union Saint-Gilloise", date: "25/11/2025", time: "18:45" },
                { home: "Borussia Dortmund", away: "Villarreal", date: "25/11/2025", time: "21:00" },
                { home: "Chelsea", away: "Barcelona", date: "25/11/2025", time: "21:00" },
                { home: "Bodø/Glimt", away: "Juventus", date: "25/11/2025", time: "21:00" },
                { home: "Manchester City", away: "Leverkusen", date: "25/11/2025", time: "21:00" },
                { home: "Marseille", away: "Newcastle United", date: "25/11/2025", time: "21:00" },
                { home: "Slavia Praha", away: "Athletic Club", date: "25/11/2025", time: "21:00" },
                { home: "Napoli", away: "Qarabağ", date: "25/11/2025", time: "21:00" },
                { home: "Copenhagen", away: "Kairat Almaty", date: "26/11/2025", time: "18:45" },
                { home: "Pafos", away: "Monaco", date: "26/11/2025", time: "18:45" },
                { home: "Arsenal", away: "Bayern München", date: "26/11/2025", time: "21:00" },
                { home: "Atlético de Madrid", away: "Inter", date: "26/11/2025", time: "21:00" },
                { home: "Frankfurt", away: "Atalanta", date: "26/11/2025", time: "21:00" },
                { home: "Liverpool", away: "PSV Eindhoven", date: "26/11/2025", time: "21:00" },
                { home: "Olympiacos", away: "Real Madrid", date: "26/11/2025", time: "21:00" },
                { home: "Paris Saint-Germain", away: "Tottenham", date: "26/11/2025", time: "21:00" },
                { home: "Sporting CP", away: "Club Brugge", date: "26/11/2025", time: "21:00" }
            ],
            [
                { home: "Kairat Almaty", away: "Olympiacos", date: "09/12/2025", time: "16:30" },
                { home: "Bayern München", away: "Sporting CP", date: "09/12/2025", time: "18:45" },
                { home: "Monaco", away: "Galatasaray", date: "09/12/2025", time: "21:00" },
                { home: "Atalanta", away: "Chelsea", date: "09/12/2025", time: "21:00" },
                { home: "Barcelona", away: "Frankfurt", date: "09/12/2025", time: "21:00" },
                { home: "Inter", away: "Liverpool", date: "09/12/2025", time: "21:00" },
                { home: "PSV Eindhoven", away: "Atlético de Madrid", date: "09/12/2025", time: "21:00" },
                { home: "Union Saint-Gilloise", away: "Marseille", date: "09/12/2025", time: "21:00" },
                { home: "Tottenham", away: "Slavia Praha", date: "09/12/2025", time: "21:00" },
                { home: "Qarabağ", away: "Ajax", date: "10/12/2025", time: "18:45" },
                { home: "Villarreal", away: "Copenhagen", date: "10/12/2025", time: "18:45" },
                { home: "Athletic Club", away: "Paris Saint-Germain", date: "10/12/2025", time: "21:00" },
                { home: "Leverkusen", away: "Newcastle United", date: "10/12/2025", time: "21:00" },
                { home: "Borussia Dortmund", away: "Bodø/Glimt", date: "10/12/2025", time: "21:00" },
                { home: "Club Brugge", away: "Arsenal", date: "10/12/2025", time: "21:00" },
                { home: "Juventus", away: "Pafos", date: "10/12/2025", time: "21:00" },
                { home: "Real Madrid", away: "Manchester City", date: "10/12/2025", time: "21:00" },
                { home: "Benfica", away: "Napoli", date: "09/12/2025", time: "21:00" }
            ],
            [
                { home: "Kairat Almaty", away: "Club Brugge", date: "20/01/2026", time: "16:30" },
                { home: "Bodø/Glimt", away: "Manchester City", date: "20/01/2026", time: "18:45" },
                { home: "Copenhagen", away: "Napoli", date: "20/01/2026", time: "21:00" },
                { home: "Inter", away: "Arsenal", date: "20/01/2026", time: "21:00" },
                { home: "Olympiacos", away: "Leverkusen", date: "20/01/2026", time: "21:00" },
                { home: "Real Madrid", away: "Monaco", date: "20/01/2026", time: "21:00" },
                { home: "Sporting CP", away: "Paris Saint-Germain", date: "20/01/2026", time: "21:00" },
                { home: "Tottenham", away: "Borussia Dortmund", date: "20/01/2026", time: "21:00" },
                { home: "Villarreal", away: "Ajax", date: "20/01/2026", time: "21:00" },
                { home: "Galatasaray", away: "Atlético de Madrid", date: "21/01/2026", time: "18:45" },
                { home: "Qarabağ", away: "Frankfurt", date: "21/01/2026", time: "18:45" },
                { home: "Atalanta", away: "Athletic Club", date: "21/01/2026", time: "21:00" },
                { home: "Chelsea", away: "Pafos", date: "21/01/2026", time: "21:00" },
                { home: "Bayern München", away: "Union Saint-Gilloise", date: "21/01/2026", time: "21:00" },
                { home: "Juventus", away: "Benfica", date: "21/01/2026", time: "21:00" },
                { home: "Newcastle United", away: "PSV Eindhoven", date: "21/01/2026", time: "21:00" },
                { home: "Marseille", away: "Liverpool", date: "21/01/2026", time: "21:00" },
                { home: "Slavia Praha", away: "Barcelona", date: "21/01/2026", time: "21:00" }
            ],
            [
                { home: "Ajax", away: "Olympiacos", date: "28/01/2026", time: "21:00" },
                { home: "Arsenal", away: "Kairat Almaty", date: "28/01/2026", time: "21:00" },
                { home: "Monaco", away: "Juventus", date: "28/01/2026", time: "21:00" },
                { home: "Athletic Club", away: "Sporting CP", date: "28/01/2026", time: "21:00" },
                { home: "Atlético de Madrid", away: "Bodø/Glimt", date: "28/01/2026", time: "21:00" },
                { home: "Leverkusen", away: "Villarreal", date: "28/01/2026", time: "21:00" },
                { home: "Borussia Dortmund", away: "Inter", date: "28/01/2026", time: "21:00" },
                { home: "Club Brugge", away: "Marseille", date: "28/01/2026", time: "21:00" },
                { home: "Frankfurt", away: "Tottenham", date: "28/01/2026", time: "21:00" },
                { home: "Barcelona", away: "Copenhagen", date: "28/01/2026", time: "21:00" },
                { home: "Liverpool", away: "Qarabağ", date: "28/01/2026", time: "21:00" },
                { home: "Manchester City", away: "Galatasaray", date: "28/01/2026", time: "21:00" },
                { home: "Pafos", away: "Slavia Praha", date: "28/01/2026", time: "21:00" },
                { home: "Paris Saint-Germain", away: "Newcastle United", date: "28/01/2026", time: "21:00" },
                { home: "PSV Eindhoven", away: "Bayern München", date: "28/01/2026", time: "21:00" },
                { home: "Union Saint-Gilloise", away: "Atalanta", date: "28/01/2026", time: "21:00" },
                { home: "Benfica", away: "Real Madrid", date: "28/01/2026", time: "21:00" },
                { home: "Napoli", away: "Chelsea", date: "28/01/2026", time: "21:00" }
            ]
        ];

        const teams = [
            "Ajax", "Arsenal", "Atalanta", "Athletic Club", "Atlético de Madrid", "Barcelona", "Bayern München",
            "Benfica", "Bodø/Glimt", "Borussia Dortmund", "Chelsea", "Club Brugge", "Copenhagen", "Frankfurt",
            "Galatasaray", "Inter", "Juventus", "Kairat Almaty", "Leverkusen", "Liverpool", "Manchester City",
            "Marseille", "Monaco", "Napoli", "Newcastle United", "Olympiacos", "Pafos", "Paris Saint-Germain",
            "PSV Eindhoven", "Qarabağ", "Real Madrid", "Slavia Praha", "Sporting CP", "Tottenham", "Union Saint-Gilloise", "Villarreal"
        ];

        let leagueTable = teams.map(team => ({
            team,
            played: 0,
            won: 0,
            drawn: 0,
            lost: 0,
            goalsFor: 0,
            goalsAgainst: 0,
            goalDifference: 0,
            points: 0
        }));

        let teamConditions = teams.reduce((acc, team) => ({
            ...acc,
            [team]: { fatigue: 0, injury: null, form: 0 }
        }), {});

        function updateTeamConditions(match, index) {
            const matchDate = new Date(match.date.split("/").reverse().join("-") + "T" + match.time);
            const prevMatches = matches.flat().slice(0, index).filter(m => m.home === match.home || m.away === match.home || m.home === match.away || m.away === match.away);
            const recentMatches = prevMatches.filter(m => {
                const prevDate = new Date(m.date.split("/").reverse().join("-") + "T" + m.time);
                return (matchDate - prevDate) / (1000 * 60 * 60 * 24) <= 10;
            });

            [match.home, match.away].forEach(team => {
                const recentTeamMatches = recentMatches.filter(m => m.home === team || m.away === team).length;
                teamConditions[team].fatigue = recentTeamMatches >= 3 ? -5 : 0;

                if (Math.random() < 0.1) {
                    const roles = ["Striker", "Midfielder", "Defender"];
                    teamConditions[team].injury = roles[Math.floor(Math.random() * roles.length)];
                } else {
                    teamConditions[team].injury = null;
                }

                const lastThree = prevMatches.slice(-3).filter(m => m.home === team || m.away === team);
                let form = 0;
                lastThree.forEach(m => {
                    const homeInput = document.getElementById(`home-score-${matches.flat().indexOf(m)}`);
                    const awayInput = document.getElementById(`away-score-${matches.flat().indexOf(m)}`);
                    if (homeInput && awayInput && homeInput.value !== "" && awayInput.value !== "") {
                        const homeGoals = parseInt(homeInput.value) || 0;
                        const awayGoals = parseInt(awayInput.value) || 0;
                        if (m.home === team) {
                            form += homeGoals > awayGoals ? 3 : homeGoals === awayGoals ? 1 : -3;
                        } else {
                            form += awayGoals > homeGoals ? 3 : awayGoals === homeGoals ? 1 : -3;
                        }
                    }
                });
                teamConditions[team].form = Math.min(Math.max(form, -6), 6);
            });
        }

        function poissonRandomNumber(lambda) {
            let L = Math.exp(-lambda);
            let k = 0;
            let p = 1;
            do {
                k++;
                p *= Math.random();
            } while (p > L);
            return k - 1;
        }

        function predictScore(homeTeam, awayTeam) {
            const useConditions = document.getElementById("conditions-toggle").checked;
            let homeRating = teamRatings[homeTeam] || 50;
            let awayRating = teamRatings[awayTeam] || 50;

            if (useConditions) {
                homeRating += teamConditions[homeTeam].fatigue + (teamConditions[homeTeam].injury ? -5 : 0) + teamConditions[homeTeam].form;
                awayRating += teamConditions[awayTeam].fatigue + (teamConditions[awayTeam].injury ? -5 : 0) + teamConditions[awayTeam].form;
                homeRating = Math.max(50, Math.min(100, homeRating));
                awayRating = Math.max(50, Math.min(100, awayRating));
            }

            const ratingDiff = (homeRating - awayRating) / 100;
            const homeBaseXG = 1.5 + ratingDiff * 0.5;
            const awayBaseXG = 1.2 - ratingDiff * 0.5;
            const homeXG = Math.max(0, homeBaseXG + (useConditions ? 0.3 : 0));
            const awayXG = Math.max(0, awayBaseXG);
            const homeGoals = poissonRandomNumber(homeXG);
            const awayGoals = poissonRandomNumber(awayXG);
            return [homeGoals, awayGoals];
        }

        function updateLeagueTable() {
            leagueTable = teams.map(team => ({
                team,
                played: 0,
                won: 0,
                drawn: 0,
                lost: 0,
                goalsFor: 0,
                goalsAgainst: 0,
                goalDifference: 0,
                points: 0
            }));

            matches.flat().forEach((match, index) => {
                const homeInput = document.getElementById(`home-score-${index}`);
                const awayInput = document.getElementById(`away-score-${index}`);
                if (homeInput && awayInput && homeInput.value !== "" && awayInput.value !== "") {
                    const homeGoals = parseInt(homeInput.value) || 0;
                    const awayGoals = parseInt(awayInput.value) || 0;

                    if (homeGoals < 0 || awayGoals < 0) return;

                    const homeTeam = leagueTable.find(t => t.team === match.home);
                    const awayTeam = leagueTable.find(t => t.team === match.away);

                    if (homeTeam && awayTeam) {
                        homeTeam.played++;
                        awayTeam.played++;
                        homeTeam.goalsFor += homeGoals;
                        homeTeam.goalsAgainst += awayGoals;
                        awayTeam.goalsFor += awayGoals;
                        awayTeam.goalsAgainst += homeGoals;
                        homeTeam.goalDifference = homeTeam.goalsFor - homeTeam.goalsAgainst;
                        awayTeam.goalDifference = awayTeam.goalsFor - awayTeam.goalsAgainst;

                        if (homeGoals > awayGoals) {
                            homeTeam.won++;
                            homeTeam.points += 3;
                            awayTeam.lost++;
                        } else if (awayGoals > homeGoals) {
                            awayTeam.won++;
                            awayTeam.points += 3;
                            homeTeam.lost++;
                        } else {
                            homeTeam.drawn++;
                            awayTeam.drawn++;
                            homeTeam.points++;
                            awayTeam.points++;
                        }
                    }
                }
            });

            leagueTable.sort((a, b) => {
                if (b.points !== a.points) return b.points - a.points;
                if (b.goalDifference !== a.goalDifference) return b.goalDifference - a.goalDifference;
                return b.goalsFor - a.goalsFor;
            });

            renderLeagueTable();
        }

        function renderLeagueTable() {
            const tbody = document.getElementById("leagueTableBody");
            tbody.innerHTML = "";
            leagueTable.forEach((team, index) => {
                const rowClass = index < 8 ? "top-8" : index < 24 ? "playoff" : "eliminated";
                const row = document.createElement("tr");
                row.className = rowClass;
                row.innerHTML = `
                    <td style="width: 6%;">${index + 1}</td>
                    <td style="width: 40%;" class="team-cell">${team.team}</td>
                    <td style="width: 6%;">${team.played}</td>
                    <td style="width: 6%;">${team.won}</td>
                    <td style="width: 6%;">${team.drawn}</td>
                    <td style="width: 6%;">${team.lost}</td>
                    <td style="width: 6%;">${team.goalsFor}</td>
                    <td style="width: 6%;">${team.goalsAgainst}</td>
                    <td style="width: 6%;">${team.goalDifference}</td>
                    <td style="width: 6%;">${team.points}</td>
                `;
                if (team.played > 0) {
                    row.style.animation = "highlight 0.5s";
                    setTimeout(() => {
                        row.style.animation = "";
                    }, 500);
                }
                tbody.appendChild(row);
            });
        }

        function renderMatches() {
            const matchdaysDiv = document.getElementById("matchdays");
            matches.forEach((matchday, dayIndex) => {
                const matchdayDiv = document.createElement("div");
                matchdayDiv.className = "bg-transparent rounded-lg shadow-lg overflow-hidden";
                matchdayDiv.innerHTML = `
                    <div class="matchday-header p-2 flex justify-between items-center">
                        <h3 class="text-base font-bold font-montserrat">Matchday ${dayIndex + 1}</h3>
                        <svg class="w-4 h-4 transform transition-transform duration-300 matchday-toggle" fill="none" stroke="#FFD700" stroke-width="2" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" d="M19 9l-7 7-7-7"/>
                        </svg>
                    </div>
                    <div class="matchday-content p-2 hidden grid grid-cols-1 gap-2">
                    </div>
                `;
                const contentDiv = matchdayDiv.querySelector(".matchday-content");
                matchday.forEach((match, matchIndex) => {
                    const globalIndex = matches.slice(0, dayIndex).reduce((sum, md) => sum + md.length, 0) + matchIndex;
                    const matchDiv = document.createElement("div");
                    matchDiv.className = "match-card p-2 rounded-lg flex flex-col space-y-1";
                    matchDiv.innerHTML = `
                        <div class="flex justify-between items-center">
                            <div class="flex-1 text-center font-semibold text-xs font-inter">
                                <span class="tooltip">
                                    ${match.home}
                                    <span id="home-condition-${globalIndex}" class="condition hidden"></span>
                                    <span class="tooltip-text">Rating based on UEFA coefficients, goals, squad value.</span>
                                </span>
                            </div>
                            <div class="flex space-x-1 items-center">
                                <input type="number" id="home-score-${globalIndex}" class="score-input" min="0" placeholder="0" aria-label="Home team score">
                                <span class="text-sm">-</span>
                                <input type="number" id="away-score-${globalIndex}" class="score-input" min="0" placeholder="0" aria-label="Away team score">
                            </div>
                            <div class="flex-1 text-center font-semibold text-xs font-inter">
                                <span class="tooltip">
                                    ${match.away}
                                    <span id="away-condition-${globalIndex}" class="condition hidden"></span>
                                    <span class="tooltip-text">Rating based on UEFA coefficients, goals, squad value.</span>
                                </span>
                            </div>
                        </div>
                        <div class="text-xs text-gray-400 text-center font-inter">${match.date} ${match.time}</div>
                    `;
                    contentDiv.appendChild(matchDiv);
                });
                matchdaysDiv.appendChild(matchdayDiv);

                matchdayDiv.querySelector(".matchday-header").addEventListener("click", () => {
                    const content = matchdayDiv.querySelector(".matchday-content");
                    const toggle = matchdayDiv.querySelector(".matchday-toggle");
                    content.classList.toggle("hidden");
                    toggle.classList.toggle("rotate-180");
                });
            });

            document.querySelectorAll(".score-input").forEach(input => {
                input.addEventListener("input", updateLeagueTable);
            });

            document.getElementById("reset-button").addEventListener("click", () => {
                document.querySelectorAll(".score-input").forEach(input => {
                    input.value = "";
                });
                teamConditions = teams.reduce((acc, team) => ({
                    ...acc,
                    [team]: { fatigue: 0, injury: null, form: 0 }
                }), {});
                updateConditionDisplays();
                updateLeagueTable();
            });

            document.getElementById("predict-button").addEventListener("click", () => {
                matches.flat().forEach((match, index) => {
                    updateTeamConditions(match, index);
                    const [homeGoals, awayGoals] = predictScore(match.home, match.away);
                    const homeInput = document.getElementById(`home-score-${index}`);
                    const awayInput = document.getElementById(`away-score-${index}`);
                    homeInput.value = homeGoals;
                    awayInput.value = awayGoals;
                    homeInput.style.animation = "highlight 0.5s";
                    awayInput.style.animation = "highlight 0.5s";
                    setTimeout(() => {
                        homeInput.style.animation = "";
                        awayInput.style.animation = "";
                    }, 500);
                });
                updateConditionDisplays();
                updateLeagueTable();
            });

            document.getElementById("conditions-toggle").addEventListener("change", () => {
                updateConditionDisplays();
                if (Array.from(document.querySelectorAll(".score-input")).some(input => input.value !== "")) {
                    updateLeagueTable();
                }
            });
        }

        function updateConditionDisplays() {
            const useConditions = document.getElementById("conditions-toggle").checked;
            matches.flat().forEach((match, index) => {
                const homeConditionSpan = document.getElementById(`home-condition-${index}`);
                const awayConditionSpan = document.getElementById(`away-condition-${index}`);
                if (useConditions) {
                    const homeConditions = [];
                    const awayConditions = [];
                    if (teamConditions[match.home].fatigue) homeConditions.push("Fatigued");
                    if (teamConditions[match.home].injury) homeConditions.push(`Injured: ${teamConditions[match.home].injury}`);
                    if (teamConditions[match.home].form > 2) homeConditions.push("Hot Form");
                    if (teamConditions[match.home].form < -2) homeConditions.push("Cold Form");
                    if (teamConditions[match.away].fatigue) awayConditions.push("Fatigued");
                    if (teamConditions[match.away].injury) awayConditions.push(`Injured: ${teamConditions[match.away].injury}`);
                    if (teamConditions[match.away].form > 2) awayConditions.push("Hot Form");
                    if (teamConditions[match.away].form < -2) awayConditions.push("Cold Form");
                    homeConditionSpan.textContent = homeConditions.join(", ");
                    awayConditionSpan.textContent = awayConditions.join(", ");
                    homeConditionSpan.classList.remove("hidden");
                    awayConditionSpan.classList.remove("hidden");
                    homeConditionSpan.className = `condition ${homeConditions.includes("Hot Form") ? "condition-hot" : homeConditions.includes("Cold Form") ? "condition-cold" : homeConditions.includes("Injured") ? "condition-injured" : "condition-fatigued"}`;
                    awayConditionSpan.className = `condition ${awayConditions.includes("Hot Form") ? "condition-hot" : awayConditions.includes("Cold Form") ? "condition-cold" : awayConditions.includes("Injured") ? "condition-injured" : "condition-fatigued"}`;
                } else {
                    homeConditionSpan.textContent = "";
                    awayConditionSpan.textContent = "";
                    homeConditionSpan.classList.add("hidden");
                    awayConditionSpan.classList.add("hidden");
                }
            });
        }

        renderMatches();
        updateLeagueTable();
    </script>
</body>
</html>